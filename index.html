<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>中西合璧浪漫情人節晚會</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,700;1,700&family=Lora:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        /* Reset and Base */
        * { box-sizing: border-box; }
        body, html { 
            margin: 0; padding: 0; width: 100%; height: 100%; 
            overflow: hidden; background-color: #fff5f7; 
            font-family: 'Lora', serif; 
        }

        /* Presentation Engine */
        #presentation-wrapper { 
            width: 100%; height: 100%; 
            transition: transform 1.2s cubic-bezier(0.65, 0, 0.35, 1); 
            display: none; 
        }

        .slide-container { 
            width: 100vw; height: 100vh; 
            position: relative;
            display: flex; 
            justify-content: center; 
            align-items: center;     
            text-align: center;
            overflow: hidden;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }

        .slide-container::after {
            content: "";
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255, 245, 247, 0.05);
            z-index: 1;
        }

        .content-card {
            position: relative;
            z-index: 10;
            width: 100%;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            animation: fadeIn 1.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h1 { 
            font-family: 'Playfair Display', serif; 
            font-size: clamp(1.8rem, 4vw, 2.8rem); 
            color: #831010; 
            margin: 0 0 10px 0; 
            font-style: italic;
            z-index: 20;
            text-shadow: 0 2px 10px rgba(255,255,255,0.8);
        }

        /* Layout for Event Photos */
        .flex-photo-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-content: center; 
            gap: 12px;
            width: 100%;
            max-width: 1200px;
            z-index: 20;
            margin: 0 auto;
        }

        .flex-photo-item {
            display: flex;
            justify-content: center;
            align-items: center;
            flex: 0 1 calc(50% - 15px); 
            max-width: calc(50% - 15px);
            line-height: 0;
            border: 3px solid #d4af37; /* Gold frame for event photos */
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            padding: 0;
            overflow: hidden;
        }

        .flex-photo-item img {
            width: 100%;
            height: 38vh;
            object-fit: cover;
            display: block;
        }

        /* Couple Page Layout */
        .photo-wrapper {
            background: white;
            padding: 10px; 
            border-radius: 4px;
            box-shadow: 0 15px 45px rgba(0,0,0,0.1);
            display: inline-block;
            z-index: 20;
            margin-bottom: 25px;
            border: none; /* No gold border for couple photos */
        }

        .img-container img {
            display: block;
            max-width: 100%;
            max-height: 55vh;
            width: auto;
            height: auto;
            object-fit: contain;
            border-radius: 2px;
        }

        .message-box {
            font-family: 'Lora', serif;
            font-size: clamp(0.9rem, 1.8vw, 1.2rem);
            color: #b71c1c;
            max-width: 800px;
            font-style: italic;
            font-weight: 700;
            line-height: 1.3;
            z-index: 20;
            background: rgba(255, 255, 255, 0.85);
            padding: 8px 30px;
            border-radius: 40px;
            backdrop-filter: blur(8px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            margin-top: 10px;
        }

        /* Hanging Hearts Banner */
        .hanging-hearts-banner {
            position: absolute;
            top: -10px;
            left: 0;
            width: 100%;
            height: 180px;
            display: flex;
            justify-content: space-around;
            z-index: 100;
            pointer-events: none;
        }

        .hanging-heart {
            display: flex;
            flex-direction: column;
            align-items: center;
            animation: swing 3.5s infinite ease-in-out;
            transform-origin: top center;
        }

        .string {
            width: 1.5px;
            background: linear-gradient(to bottom, #d4af37, #f9f295, #b8860b);
            height: var(--string-len, 40px);
        }

        .hanging-heart i {
            color: var(--heart-color, #e53935);
            font-size: 44px;
            /* High intensity glow */
            filter: drop-shadow(0 0 12px rgba(255, 64, 129, 0.6));
            animation: shimmer 2s infinite alternate ease-in-out;
        }

        @keyframes swing {
            0%, 100% { transform: rotate(-7deg); }
            50% { transform: rotate(7deg); }
        }

        @keyframes shimmer {
            0% { 
                filter: drop-shadow(0 0 5px rgba(255, 255, 255, 0.4)) brightness(1);
                transform: scale(1); 
            }
            100% { 
                filter: drop-shadow(0 0 25px rgba(255, 255, 255, 1)) brightness(1.3); 
                transform: scale(1.15); 
            }
        }

        /* UI Styling */
        #overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 9999; text-align: center;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            background-image: url('heart_background.jpg');
            background-size: cover;
            background-position: center;
            overflow: hidden;
        }

        #overlay::before {
            content: "";
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255, 255, 255, 0.4);
            z-index: 1;
        }

        .static-title {
            position: relative;
            z-index: 10;
            font-family: 'Playfair Display', serif;
            font-size: clamp(2.5rem, 8vw, 4.5rem);
            margin-top: 40px; 
            margin-bottom: 20px;
            color: #831010;
            letter-spacing: 0.1em;
            font-weight: bold;
            text-shadow: 0 2px 10px rgba(255,255,255,0.8);
        }

        .group-subtitle {
            font-size: 2.4rem; 
            color: #b71c1c;
            letter-spacing: 0.2em;
            font-weight: bold;
            z-index: 10;
            text-shadow: 0 2px 10px rgba(255,255,255,0.8);
        }

        .start-btn {
            background: #e53935;
            color: white;
            padding: 18px 60px; 
            font-size: 1.5rem; 
            border: none; 
            border-radius: 50px; 
            cursor: pointer;
            font-weight: bold;
            letter-spacing: 5px;
            margin-top: 50px;
            z-index: 100;
            box-shadow: 0 10px 30px rgba(131, 16, 16, 0.3);
            transition: transform 0.3s;
        }

        .start-btn:hover {
            transform: scale(1.05);
        }

        #ui-bar {
            position: fixed; bottom: 20px; right: 20px; 
            background: rgba(255, 255, 255, 0.9); 
            backdrop-filter: blur(10px);
            padding: 10px 20px; border-radius: 40px; 
            display: none; gap: 12px; align-items: center;
            z-index: 1000;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .control-btn { border: none; background: none; cursor: pointer; color: #831010; font-size: 1.2rem; }
        .slide-selector { background: transparent; border: none; color: #831010; font-weight: bold; font-size: 0.9rem; }
        
        #progress-container { position: fixed; top: 0; left: 0; width: 100%; height: 5px; background: rgba(0,0,0,0.1); z-index: 10000; display: none; }
        #progress-fill { height: 100%; width: 0%; background: #ff4081; }

        /* Floating Animations */
        .floating-element {
            position: absolute;
            animation: floatUp 8s infinite ease-in-out;
            opacity: 0;
            z-index: 5;
        }
        
        @keyframes floatUp {
            0% { transform: translateY(20vh) rotate(0deg); opacity: 0; }
            30% { opacity: 0.6; }
            70% { opacity: 0.6; }
            100% { transform: translateY(-110vh) rotate(20deg); opacity: 0; }
        }
    </style>
</head>
<body>

<div id="progress-container"><div id="progress-fill"></div></div>

<div id="overlay">
    <div id="heart-banner" class="hanging-hearts-banner"></div>
    <div class="static-title">中西合璧浪漫情人節晚會</div>
    <div class="group-subtitle">信望愛Agape夫婦小組</div>
    <button class="start-btn" id="start-btn">開始</button>
</div>

<audio id="bg-music"></audio>

<div id="ui-bar">
    <button onclick="toggleSlidePause()" id="slide-pause-btn" class="control-btn"><i class="fa-solid fa-pause"></i></button>
    <select id="slide-jump" class="slide-selector" onchange="jumpToSlide(this.value)"></select>
    <button onclick="toggleMusic()" id="music-toggle-btn" class="control-btn"><i class="fa-solid fa-volume-high"></i></button>
    <button onclick="playNextTrack()" class="control-btn"><i class="fa-solid fa-forward"></i></button>
</div>

<div id="presentation-wrapper"></div>

<script>
    const musicPlaylist = [
        "All_Out_of_Love.mp3",
        "right-here-waiting-richard-marx.mp3",
        "my_heart_will_go_on.mp3",
        "Nothing_s_Gonna_Change_My_Love_For_You.mp3",
        "Ocean_Deep.mp3",
        "Everything_I_Do_It_For_You.mp3"
    ];

    const couples = [
        { name: "山哥 & Candy", img: "山哥&Candy.jpeg", msg: "A night dedicated to the timeless power of love." },
        { name: "Sum & Nancy", img: "Sum&Nancy.jpeg", msg: "Journeying together through the melody of life." },
        { name: "Fred & Helen", img: "Fred&Helen.jpeg", msg: "Love is the greatest gift of all." },
        { name: "Francis & Rachel", img: "Francis&Rachel.jpeg", msg: "Building a beautiful future together." },
        { name: "Philip & Polly", img: "Philip&Polly.jpeg", msg: "Forever and always." },
        { name: "馬生 & 馬太", img: "馬生&馬太.jpg", msg: "Grace and Love." },
        { name: "Kwok & Dale", img: "Kwok&Dale.jpeg", msg: "Shared moments, lasting memories." },
        { name: "Stephen & Julianne", img: "Stephen&Julianne.jpeg", msg: "Strength in unity." },
        { name: "Paul & Lucy", img: "Paul&Lucy.jpg", msg: "A blessing to each other." },
        { name: "安哥 & River", img: "安哥&River.jpg", msg: "Heart to heart." },
        { name: "波叔 & 波嬸", img: "波叔&波嬸.jpg", msg: "Endless love." },
        { name: "Ray & Mona", img: "Ray&Mona.jpeg", msg: "Joy in every step." },
        { name: "Sam & Irene", img: "Sam&Irene.jpeg", msg: "Together in faith." },
        { name: "Winston & Wendy", img: "Winston&Wendy.jpeg", msg: "A beautiful journey." },
        { name: "Brandon & Flora", img: "Brandon&Flora.jpeg", msg: "True companionship." },
        { name: "Hong & Sandy", img: "Sandy&Hong.jpeg", msg: "Kindness and devotion." },
        { name: "祥哥 & 珍姐", img: "祥哥&珍姐.jpg", msg: "Woven together by love." },
        { name: "Sam & Amy", img: "Sam&Amy.jpeg", msg: "Patient and kind." },
        { name: "Owen & WaiWai", img: "Owen&WaiWai.jpeg", msg: "Laughter and life." },
        { name: "Gabriel & Van", img: "Gabriel&Van.jpeg", msg: "The heart of our group." },
        { name: "邱牧師 & 邱師母", img: "邱牧師&邱師母.jpg", msg: "Devoted hearts." },
        { name: "Nick & Dakki", img: "couple22.jpeg", msg: "Purest affection." },
        { name: "龍牧師 & 龍師母", img: "龍牧師&龍師母.jpeg", msg: "Hand in hand." },
        { name: "Benny & Vivian", img: "Benny&Vivian.jpeg", msg: "Radiant love." },
        { name: "Leo & Linda", img: "Leo&Linda.jpeg", msg: "Always and Forever." }
    ];

    const eventPages = [
        { title: "晚會精彩花絮 1", imgs: ["1.jpg", "2.jpg", "3.jpg", "4.jpg"], msg: "珍貴時刻，永恆回憶" },
        { title: "晚會精彩花絮 2", imgs: ["p5.jpg", "p6.jpg", "p7.jpg", "p8.jpg"], msg: "共聚一堂，分享喜悅" },
        { title: "晚會精彩花絮 3", imgs: ["p9.jpg", "p10.jpg", "p11.jpg", "12.jpg"], msg: "歡笑不斷，愛意滿滿" },
        { title: "晚會精彩花絮 4", imgs: ["p13.jpg", "p14.jpg", "p15.jpg", "p16.jpg"], msg: "" },
        { title: "晚會精彩花絮 5", imgs: ["p17.jpg", "p18.jpg", "p19.jpg", "p20.jpg"], msg: "" },
        { title: "晚會精彩花絮 6", imgs: ["p21.jpg", "p22.jpg", "p23.jpg", "p24.jpg"], msg: "" },
        { title: "晚會精彩花絮 7", imgs: ["p25.jpg", "p26.jpg", "p27.jpg", "p28.jpg"], msg: "" },
        { title: "晚會精彩花絮 8", imgs: ["p29.jpg", "p30.jpg", "p31.jpg", "p32.jpg"], msg: "" },
        { title: "晚會精彩花絮 9", imgs: ["p33.jpg", "p34.jpg", "p35.jpg", "p36.jpg"], msg: "" },
        { title: "晚會精彩花絮 10", imgs: ["p37.jpg", "p38.jpg", "p39.jpg", "p40.jpg"], msg: "" },
        { title: "晚會精彩花絮 11", imgs: ["p41.jpg", "p42.jpg", "p43.jpg", "p44.jpg"], msg: "" },
        { title: "晚會精彩花絮 12", imgs: ["p45.jpg", "p46.jpg", "p47.jpg", "p48.jpg"], msg: "" },
        { title: "晚會精彩花絮 13", imgs: ["p49.jpg", "p50.jpg", "p51.jpg", "p52.jpg"], msg: "" },
        { title: "晚會精彩花絮 14", imgs: ["p53.jpg", "p54.jpg", "p55.jpg", "p56.jpg"], msg: "" },
        { title: "晚會精彩花絮 15", imgs: ["p57.jpg", "p58.jpg", "p59.jpg", "p60.jpg"], msg: "" },
        { title: "晚會精彩花絮 16", imgs: ["p61.jpg", "p62.jpg", "p63.jpg", "p64.jpg"], msg: "" },
        { title: "晚會精彩花絮 17", imgs: ["p65.jpg", "p66.jpg", "p67.jpg", "p68.jpg"], msg: "" },
        { title: "晚會精彩花絮 18", imgs: ["p69.jpg", "p70.jpg", "p71.jpg", "p72.jpg"], msg: "" },
        { title: "晚會精彩花絮 19", imgs: ["p73.jpg", "p74.jpg", "p75.jpg", "p76.jpg"], msg: "" },
        { title: "晚會精彩花絮 20", imgs: ["p77.jpg", "p78.jpg", "p79.jpg", "p80.jpg"], msg: "" }
    ];

    let currentSlide = 0;
    let progress = 0;
    const duration = 15000; 
    let slidesPaused = false;
    let lastTick = 0;
    let totalSlides = 0;
    
    const audio = document.getElementById('bg-music');
    const wrapper = document.getElementById('presentation-wrapper');
    const slideJump = document.getElementById('slide-jump');

    function generateSlideHTML(item, isCouple = true) {
        if (isCouple) {
            return `
                <div class="content-card">
                    <h1>${item.name}</h1>
                    <div class="photo-wrapper">
                        <div class="img-container"><img src="${item.img}" onerror="this.src='https://placehold.co/600x400?text=Photo'"></div>
                    </div>
                    <div class="message-box">${item.msg}</div>
                </div>
            `;
        } else {
            return `
                <div class="content-card">
                    <h1>${item.title}</h1>
                    <div class="flex-photo-container">
                        ${item.imgs.map(img => `
                            <div class="flex-photo-item">
                                <img src="${img}" onerror="this.src='https://placehold.co/500x350?text=Photo'">
                            </div>
                        `).join('')}
                    </div>
                    ${item.msg ? `<div class="message-box">${item.msg}</div>` : ''}
                </div>
            `;
        }
    }

    function createSlides() {
        couples.forEach((c, i) => {
            const slide = document.createElement('div');
            slide.className = 'slide-container';
            slide.style.backgroundImage = "url('floral_background.png')";
            slide.innerHTML = generateSlideHTML(c, true);
            addFloatingElements(slide, 'fa-heart', ['#ff80ab', '#ff4081', '#f06292']);
            wrapper.appendChild(slide);
            const opt = document.createElement('option');
            opt.value = i;
            opt.innerText = c.name;
            slideJump.appendChild(opt);
        });

        eventPages.forEach((e, i) => {
            const idx = couples.length + i;
            const slide = document.createElement('div');
            slide.className = 'slide-container';
            slide.style.backgroundImage = "url('festive_background.webp')";
            slide.innerHTML = generateSlideHTML(e, false);
            addFloatingElements(slide, 'fa-circle', ['#2196f3', '#ff80ab', '#ffeb3b', '#d4af37'], true);
            wrapper.appendChild(slide);
            const opt = document.createElement('option');
            opt.value = idx;
            opt.innerText = e.title;
            slideJump.appendChild(opt);
        });

        totalSlides = couples.length + eventPages.length;
    }

    function addFloatingElements(parent, iconClass, customColors, isBalloon = false) {
        for (let i = 0; i < 10; i++) {
            const el = document.createElement('i');
            el.className = `fa-solid ${iconClass} floating-element`;
            el.style.left = Math.random() * 95 + 'vw';
            el.style.bottom = '-10%';
            el.style.fontSize = (Math.random() * 20 + 20) + 'px';
            el.style.animationDelay = (Math.random() * 5) + 's';
            el.style.color = customColors[Math.floor(Math.random() * customColors.length)];
            
            if (isBalloon) {
                el.style.filter = 'drop-shadow(0 2px 5px rgba(0,0,0,0.1))';
            }
            
            parent.appendChild(el);
        }
    }

    function createHangingBanner() {
        const banner = document.getElementById('heart-banner');
        // Rich vibrant colors, removed light pink/white tones
        const colors = ['#e91e63', '#ff1744', '#d50000', '#c2185b', '#f44336'];
        const count = 10;
        for (let i = 0; i < count; i++) {
            const container = document.createElement('div');
            container.className = 'hanging-heart';
            const stringLen = Math.floor(Math.random() * 70) + 40;
            container.style.setProperty('--string-len', stringLen + 'px');
            container.style.animationDelay = (Math.random() * 2) + 's';
            
            // Assign deep colors to all hearts to prevent "pale" appearance
            container.style.setProperty('--heart-color', colors[i % colors.length]);
            
            const string = document.createElement('div');
            string.className = 'string';
            const heart = document.createElement('i');
            heart.className = 'fa-solid fa-heart';
            heart.style.animationDuration = (2 + Math.random()) + 's';
            
            container.appendChild(string);
            container.appendChild(heart);
            banner.appendChild(container);
        }
    }

    function slideLoop() {
        const now = Date.now();
        const delta = now - lastTick;
        lastTick = now;
        if (!slidesPaused) {
            progress += delta;
            const percent = (progress / duration) * 100;
            const fill = document.getElementById('progress-fill');
            if(fill) fill.style.width = Math.min(percent, 100) + '%';
            if (progress >= duration) {
                progress = 0;
                currentSlide = (currentSlide + 1) % totalSlides;
                jumpToSlide(currentSlide);
            }
        }
        requestAnimationFrame(slideLoop);
    }

    function init() {
        document.getElementById('overlay').style.display = 'none';
        wrapper.style.display = 'block';
        document.getElementById('progress-container').style.display = 'block';
        document.getElementById('ui-bar').style.display = 'flex';
        audio.src = musicPlaylist[0];
        audio.play().catch(() => {});
        audio.addEventListener('ended', playNextTrack);
        lastTick = Date.now();
        requestAnimationFrame(slideLoop);
    }

    function jumpToSlide(idx) {
        currentSlide = parseInt(idx);
        progress = 0;
        slideJump.value = currentSlide;
        wrapper.style.transform = `translateY(-${currentSlide * 100}vh)`;
    }

    function toggleSlidePause() {
        slidesPaused = !slidesPaused;
        document.getElementById('slide-pause-btn').innerHTML = slidesPaused ? '<i class="fa-solid fa-play"></i>' : '<i class="fa-solid fa-pause"></i>';
    }

    function toggleMusic() {
        if (audio.paused) audio.play(); else audio.pause();
        document.getElementById('music-toggle-btn').innerHTML = audio.paused ? '<i class="fa-solid fa-volume-xmark"></i>' : '<i class="fa-solid fa-volume-high"></i>';
    }

    function playNextTrack() {
        const parts = audio.src.split('/');
        const currentFile = parts[parts.length - 1];
        let nextIdx = (musicPlaylist.indexOf(currentFile) + 1) % musicPlaylist.length;
        audio.src = musicPlaylist[nextIdx];
        audio.play().catch(e => console.error(e));
        document.getElementById('music-toggle-btn').innerHTML = '<i class="fa-solid fa-volume-high"></i>';
    }

    window.onload = () => {
        createSlides();
        createHangingBanner();
        document.getElementById('start-btn').addEventListener('click', init);
    };
</script>
</body>
</html>
